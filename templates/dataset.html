{% extends "base.html" %}
{% block title %}Dataset - LLM Security Testing{% endblock %}
{% block content %}
<div class="card">
    <h2>ğŸ“Š Malicious Prompts Dataset</h2>
    <button class="btn" onclick="generateDataset()">ğŸš€ Generate Dataset</button>
    <button class="btn btn-secondary" onclick="viewDataset()">ğŸ“„ View Dataset</button>
    <div id="dataset-status" style="margin-top: 20px;"></div>
    <div id="dataset-content" style="margin-top: 20px;"></div>
</div>

<div class="card">
    <h2>ğŸ“‹ Attack Categories (15 Types)</h2>
    <ul style="line-height: 2; padding-left: 20px; color: #4a5568;">
        <li>ğŸ¯ Direct Jailbreak - Explicit bypass attempts</li>
        <li>ğŸ­ Role Playing - Persona-based exploitation</li>
        <li>ğŸ’‰ Prompt Injection - Context manipulation</li>
        <li>ğŸ”“ DAN Mode - Unrestricted mode activation</li>
        <li>ğŸ¬ Hypothetical - Fictional framing</li>
        <li>ğŸ” Encoded - Base64/ROT13 obfuscation</li>
        <li>ğŸ‘¤ Social Engineering - Trust exploitation</li>
        <li>ğŸ”€ Context Switching - Topic transitions</li>
        <li>ğŸ“Š Multi-Step - Gradual escalation</li>
        <li>ğŸ‘‘ Authority - False credentials</li>
        <li>ğŸ’” Emotional - Sympathy exploitation</li>
        <li>âœ‚ï¸ Fragmented - Character splitting</li>
        <li>ğŸ”„ Contrarian - Reverse psychology</li>
        <li>ğŸ­ Hybrid - Legitimate disguise</li>
        <li>ğŸ” Extraction - System prompt leakage</li>
    </ul>
</div>
{% endblock %}

{% block extra_js %}
<script>
function generateDataset() {
    const statusDiv = document.getElementById('dataset-status');
    statusDiv.innerHTML = '<div class="spinner"></div>';
    
    fetch('/api/generate-dataset', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'}
    })
    .then(res => res.json())
    .then(data => {
        statusDiv.innerHTML = '';
        if (data.success) {
            showAlert(data.message, 'success');
        } else {
            showAlert('Error: ' + data.error, 'error');
        }
    })
    .catch(err => {
        statusDiv.innerHTML = '';
        showAlert('Error: ' + err.message, 'error');
    });
}

function viewDataset() {
    const contentDiv = document.getElementById('dataset-content');
    contentDiv.innerHTML = '<div class="spinner"></div>';
    
    fetch('/api/dataset')
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            let html = '<table><thead><tr><th>Category</th><th>Prompt</th></tr></thead><tbody>';
            data.data.slice(0, 30).forEach(item => {
                html += `<tr><td><strong>${item.category}</strong></td><td>${item.prompt}</td></tr>`;
            });
            html += '</tbody></table>';
            contentDiv.innerHTML = html;
        } else {
            contentDiv.innerHTML = `<div class="alert alert-error">${data.error}</div>`;
        }
    })
    .catch(err => {
        contentDiv.innerHTML = `<div class="alert alert-error">Error: ${err.message}</div>`;
    });
}
</script>
{% endblock %}